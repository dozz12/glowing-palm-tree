<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThurGPT v4.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #020617; color: white; font-family: sans-serif; }
        .loader { border-top-color: #8b5cf6; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-6 flex flex-col items-center justify-center min-h-screen">
    <div class="max-w-xl w-full space-y-6 text-center">
        <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-blue-500">ThurGPT v4.0</h1>
        
        <textarea id="prompt" class="w-full p-4 bg-slate-900 border border-slate-800 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none h-32" placeholder="Ketik deskripsi gambar di sini..."></textarea>
        
        <button id="genBtn" class="w-full py-4 bg-purple-600 hover:bg-purple-500 rounded-xl font-bold transition-all active:scale-95">BUAT GAMBAR</button>
        
        <div id="result" class="mt-8 border-2 border-dashed border-slate-800 rounded-2xl aspect-square flex items-center justify-center overflow-hidden">
            <p id="status" class="text-slate-500">Hasil akan muncul di sini</p>
            <div id="spinner" class="hidden w-12 h-12 border-4 border-slate-700 loader rounded-full"></div>
            <img id="output" class="hidden w-full h-full object-cover" />
        </div>
    </div>

    <script>
        // PENTING: Di Vercel, pastikan kamu isi Environment Variable dengan nama API_KEY
        // Kode ini akan mencoba mengambil API Key dari sistem
        const apiKey = ""; // Biarkan kosong, nanti sistem yang urus

        document.getElementById('genBtn').onclick = async () => {
            const prompt = document.getElementById('prompt').value;
            const status = document.getElementById('status');
            const spinner = document.getElementById('spinner');
            const output = document.getElementById('output');
            const btn = document.getElementById('genBtn');

            if (!prompt) return alert("Isi dulu prompt-nya!");

            btn.disabled = true;
            status.classList.add('hidden');
            output.classList.add('hidden');
            spinner.classList.remove('hidden');

            try {
                // Gunakan URL model Imagen 4.0
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        instances: { prompt: prompt },
                        parameters: { sampleCount: 1 }
                    })
                });

                const data = await res.json();
                const base64 = data.predictions?.[0]?.bytesBase64Encoded;

                if (base64) {
                    output.src = `data:image/png;base64,${base64}`;
                    output.classList.remove('hidden');
                } else {
                    status.innerText = "Gagal. Cek API Key di Vercel Settings!";
                    status.classList.remove('hidden');
                }
            } catch (e) {
                status.innerText = "Error: " + e.message;
                status.classList.remove('hidden');
            } finally {
                spinner.classList.add('hidden');
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>

